{#-
  This file was automatically generated - do not edit
-#}

{% from "partials/macros.html" import render_title_with_icon %}

{% if "material/tags" in config.plugins and tags %}
  {% include "partials/tags.html" %}
{% endif %}  

{% set badge_html = '' %}
{% if page.meta and page.meta.tutorial_badge %}
  {% set badge_html = '<span class="badge ' ~ (page.meta.tutorial_badge | lower | replace(".", "-")) ~ '">' ~ (page.meta.tutorial_badge | capitalize) ~ '</span>' %}
{% endif %}

{% if "\x3ch1" in page.content %}
  {% set rendered_content = page.content | replace('</h1>', '</h1>' ~ badge_html, 1) %}
{% else %}
  {% set rendered_content = '<h1>' ~ (page.title | d(config.site_name, true)) ~ '</h1>' ~ badge_html ~ page.content %}
{% endif %}

{% if "faq" in page.url %}
  {# Split content for each FAQ by h2 #}
  {% set h2_sections = rendered_content.split('<h2') %}
  {% set intro_content = h2_sections[0] %}
  
  {# Keep any introduction content intact #}
  {% if intro_content %}
    {{ intro_content | safe }}
  {% endif %}
  
  {# Process each FAQ section #}
  {% for i in range(1, h2_sections | length) %}
    {% set section = h2_sections[i] %}
    {% set section_counter = loop.index %}
    
    {# Extract h2 content #}
    {% set h2_end = section.find('</h2>') %}
    {% if h2_end != -1 %}
      {% set h2_full = section[:h2_end] %}
      {% set h2_content_start = h2_full.find('>') + 1 %}
      {% set h2_text = h2_full[h2_content_start:] %}
      {% set h2_attributes = h2_full[:h2_content_start-1] %}
      {% set normalized_h2_text = h2_text | striptags | trim %}
      {% set h2_attributes_lower = h2_attributes | lower %}
      {% set is_excluded_h2 = normalized_h2_text == "Where to Go Next" or 'id="where-to-go-next"' in h2_attributes_lower %}
      
      {# Extract ID from h2 attributes #}
      {% set id_start = h2_attributes.find('id="') %}
      {% set h2_id = '' %}
      {% if id_start != -1 %}
        {% set id_start = id_start + 4 %}
        {% set id_end = h2_attributes.find('"', id_start) %}
        {% set h2_id = h2_attributes[id_start:id_end] %}
      {% endif %}
      
      {# Get content after h2 until next h2 or end of page #}
      {% set section_content = section[h2_end + 5:] %}
      
      {% if is_excluded_h2 %}
        <h2{{ h2_attributes | safe }}>{{ h2_text | safe }}</h2>
        {{ section_content | safe }}
      {% else %}
        {# Generate unique details ID #}
        {% set details_id = ('faq-' ~ page.url ~ '-' ~ section_counter)
          | replace('/', '-')
          | replace('?', '')
          | replace('#', '')
          | replace('.', '-')
          | replace(' ', '-')
          | replace('--', '-') %}      
        <details class="interface faq" id="{{ details_id }}">
          <summary>
            <h2{% if h2_id %} id="{{ h2_id }}"{% endif %}>{{ h2_text | safe }}</h2>
          </summary>
          {{ section_content | safe }}
        </details>
      {% endif %}
    {% endif %}
  {% endfor %}
{% else %}
  {{ rendered_content | safe }}
{% endif %}

{% include "partials/source-file.html" %}
{% include "partials/comments.html" %}

{% if "navigation.footer" in features %}
  {% if page.previous_page or page.next_page %}
    {% if page.meta and page.meta.hide %}
      {% set hidden = "hidden" if "footer" in page.meta.hide %}
    {% endif %}
    <nav class="md-footer__inner md-grid" aria-label="{{ lang.t('footer') }}" {{ hidden }}>
      {% if page.previous_page %}
        {% set direction = lang.t("footer.previous") %}
        <div class="footer-link-wrapper prev">
          <div class="md-footer__button md-icon">
            {% set icon = config.theme.icon.previous or "material/arrow-left" %}
            {% include ".icons/" ~ icon ~ ".svg" %}
            <span class="md-footer__direction">
              {{ direction }}
            </span>
          </div>
          <a href="{{ page.previous_page.url | url }}" class="md-footer__link md-footer__link--prev" aria-label="{{ direction }}: {{ page.previous_page.title | e }}">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                {{ render_title_with_icon(page.previous_page.title) }}
              </div>
            </div>
          </a>
        </div>
      {% endif %}
      {% if page.next_page %}
        {% set direction = lang.t("footer.next") %}
        <div class="footer-link-wrapper next">
          <div class="md-footer__button md-icon">
            <span class="md-footer__direction">
              {{ direction }}
            </span>
            {% set icon = config.theme.icon.next or "material/arrow-right" %}
            {% include ".icons/" ~ icon ~ ".svg" %}
          </div>
          <a href="{{ page.next_page.url | url }}" class="md-footer__link md-footer__link--next" aria-label="{{ direction }}: {{ page.next_page.title | e }}">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                {{ render_title_with_icon(page.next_page.title) }}
              </div>
            </div>
          </a>
        </div>
      {% endif %}
    </nav>
  {% endif %}
{% endif %}
