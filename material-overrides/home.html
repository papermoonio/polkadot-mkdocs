{% extends "main.html" %}

{% block htmltitle %}
  <title>Polkadot Developer Docs</title>
{% endblock %}

{% block styles %}
	{{ super() }}
  <link rel="stylesheet" href="{{ 'assets/stylesheets/home.css' | url }}">
{% endblock %}

{%- block container -%} 
  {% block content %}
    <div class="home-container md-typeset">

      <section class="hero-section">
        <canvas id="grain-canvas" class="grain-canvas"></canvas>
        <div class="hero-content">
          <h1>Polkadot Documentation</h1>
          <p class="tagline">Everything you need to start building on Polkadot.</p>
          <div class="button-wrapper">
            <a href="smart-contracts/overview/">
              <button class="md-button">Start Building
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </button>
            </a>     
            <a href="smart-contracts/connect/">
              <button class="md-button secondary">Connect to Polkadot
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </button>
            </a>
          </div>
        </div>
      </section>

      <div class="md-grid column">
        <div class="feature-section">
          <div class="featured-content row">
            <div class="card column">
              <h3>Smart Contracts</h3>
              <a href="/smart-contracts/connect/">
                Connect to Polkadot
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
              <a href="/smart-contracts/cookbook/smart-contracts/deploy-basic/basic-remix/">
                Deploy a contract
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
              <a href="/smart-contracts/precompiles/">
                Leverage precompiled contracts
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
            </div>
            <div class="card column">
              <h3>Blockchains</h3>
              <a href="/parachains/install-polkadot-sdk/">
                Install the Polkadot SDK
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
              <a href="/parachains/launch-a-parachain/set-up-the-parachain-template/">
                Launch a simple blockchain
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
              <a href="/parachains/customize-runtime/">
                Customize your chain
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
              <a href="/parachains/runtime-maintenance/runtime-upgrades/">
                Upgrade your chain
                <span class="twemoji">
                  {% include ".icons/material/arrow-right.svg" %} 
                </span>
              </a>
            </div>
            <div class="card column">
              <h3>Developer Resources</h3>
              <a href="https://wiki.polkadot.com/general/grants/" target="_blank">
                Explore grants and funding opportunities
                <span class="twemoji">
                  {% include ".icons/material/arrow-top-right.svg" %} 
                </span>
              </a>
              <a href="https://polkadot.academy/" target="_blank">
                Discover the Polkadot Academy
                <span class="twemoji">
                  {% include ".icons/material/arrow-top-right.svg" %} 
                </span>
              </a>
              <a href="https://www.parity.io/bug-bounty" target="_blank">
                Report a bug via the bug bounty program
                <span class="twemoji">
                  {% include ".icons/material/arrow-top-right.svg" %} 
                </span>
              </a>
            </div>
          </div>
        </div>
      </div>

    </div>
  {% endblock %}
{%- endblock -%} 


{% block scripts %}
  {{ super() }}
  <script>
    const canvas = document.querySelector('.grain-canvas');
    const ctx = canvas.getContext('2d');
    const hero = document.querySelector('.hero-section');

    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');

    function resizeCanvas() {
      const rect = hero.getBoundingClientRect();
      width = canvas.width = Math.max(1, Math.floor(rect.width));
      height = canvas.height = Math.max(1, Math.floor(rect.height));
    }

    let width = 1;
    let height = 1;
    resizeCanvas();

    // Generate grain frame
    function generateGrain() {
      const imgData = ctx.createImageData(width, height);
      const alpha = 28;

      for (let i = 0; i < imgData.data.length; i += 4) {
        const v = Math.random() * 255;
        imgData.data[i] = v;         // R
        imgData.data[i + 1] = v;     // G
        imgData.data[i + 2] = v;     // B
        imgData.data[i + 3] = alpha; // A
      }

      return imgData;
    }

    let grain = generateGrain();
    let rafId = null;

    let smoothX = width * 0.5;
    let smoothY = height * 0.38;
    const baseEase = 0.03;
    const minEase = 0.007; // visible entry
    const rampDurationMs = 2200; // smoother entry
    let startTs = null;
    let seeded = false;

    function draw(t) {
      if (prefersReducedMotion.matches) {
        ctx.clearRect(0, 0, width, height);
        ctx.putImageData(grain, 0, 0);

        const x = width * 0.5;
        const y = height * 0.35;
        const gradient = ctx.createRadialGradient(x, y, 0, x, y, 600);
        gradient.addColorStop(0, 'rgba(255,255,255,0.12)');
        gradient.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, width, height);
        return;
      }

      if (startTs === null) startTs = t;

      if (!seeded) {
        const time0 = t * 0.00025;
        smoothX = width * (0.5 + 0.28 * Math.cos(time0));
        smoothY = height * (0.42 + 0.20 * Math.sin(time0 * 1.15));
        seeded = true;
      }

      if (!draw.lastGrainTs || t - draw.lastGrainTs > 120) {
        grain = generateGrain();
        draw.lastGrainTs = t;
      }

      ctx.clearRect(0, 0, width, height);
      ctx.putImageData(grain, 0, 0);

      const time = t * 0.00025; // speed
      const targetX = width * (0.5 + 0.28 * Math.cos(time));
      const targetY = height * (0.42 + 0.20 * Math.sin(time * 1.15));

      const elapsed = t - startTs;
      const ramp = Math.min(1, elapsed / rampDurationMs);
      const ease = minEase + (baseEase - minEase) * ramp;
      smoothX += (targetX - smoothX) * ease;
      smoothY += (targetY - smoothY) * ease;

      const x = smoothX;
      const y = smoothY;

      const gradient = ctx.createRadialGradient(x, y, 0, x, y, 900);
      gradient.addColorStop(0, 'rgba(255,255,255,0.18)');
      gradient.addColorStop(0.35, 'rgba(255,255,255,0.08)');
      gradient.addColorStop(1, 'rgba(255,255,255,0)');

      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, width, height);

      rafId = requestAnimationFrame(draw);
    }

    function start() {
      if (rafId) cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(draw);
    }

    prefersReducedMotion.addEventListener('change', () => {
      grain = generateGrain();

      smoothX = width * 0.5;
      smoothY = height * 0.38;
      startTs = null;
      seeded = false;

      start();
    });

    const ro = new ResizeObserver(() => {
      resizeCanvas();
      grain = generateGrain();
      smoothX = width * 0.5;
      smoothY = height * 0.38;
      startTs = null;
      seeded = false;
      start();
    });
    ro.observe(hero);

    start();
  </script>
{% endblock %}
